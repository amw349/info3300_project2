<html>
<head>
<title>P2</title>
<link href="https://fonts.googleapis.com/css?family=Alegreya|Alegreya+Sans" rel="stylesheet">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">
<link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="http://d3js.org/topojson.v2.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
<style>
body { font-family: 'Alegreya Sans', Calibri, sans-serif; margin: auto; background-color: #444444;}
svg { border: solid #ccc 1px; background-color: white; box-shadow: 5px 10px 50px white;}
path.country { fill: #ccc; stroke: #888;; }
#mainCenter {
    margin: auto;
    text-align: center;
    color: white;
    font-size: 20px;
}
h1 {
    color: white;
    box-shadow: 5px 10px 50px white
}
</style>
</head>
<body>

<div id="mainCenter">
    <h1><br>
        Effect of Contraceptive Prevalence on the Percent of <br> Females Who Complete Primary School
    </h1>

<svg height="650" width="1400">
</svg>
    <input type="range" name='politics' min="0" max="90" value="0" step="1" style='width:420px' onchange="showValue(this.value)" />
    <span id="range">&nbsp; &nbsp; &nbsp; &nbsp; 0%</span>
    <script type="text/javascript">
    function showValue(newValue)
    {
        var percentSign = "%";
        var percent = String(newValue);
        var total = percent.concat(percentSign);
        document.getElementById("range").innerHTML= total;
    }
    </script>
    <br>
    <br>
    The graph above shows the relationship between access to contraceptives and the percentage of females who complete primary school.
    <br>
    Use the slider to select a percentage of women who have access to 
</div>


<script id="make_map">

var svg = d3.select("svg");
svg.append("text")
.attr("id", "CountryName")
.attr("x", 10)
.attr("y", 28)
.style("font-size", "18pt");

var projection = d3.geoMercator().scale(150).translate([675,450]);
var pathGenerator = d3.geoPath().projection(projection);

var geoData;
var contraData;
var countries;




//code based from lecture and http://www.tnoda.com/blog/2013-12-07
//data from https://raw.githubusercontent.com/yaph/d3-geomap/master/src/topojson/world/countries.json

d3.queue()
.defer(d3.json, "world.json")
.defer(d3.csv, "birth_control_country_data.csv")
.await(function (error, worldData, csvData) {

	geoData = worldData;
	contraData = csvData;

	
	countries = topojson.feature(geoData, geoData.objects.units);
	svg.append("g")
    .attr("id", "countries")
    .selectAll("path.country")
    .data(countries.features)
    .enter()
    .append("path")
    .attr("class", "country")
    .attr("id", function(d) { return d.properties.name; })
    .attr("d", function (country) {
        if(country.properties.name != "Antarctica")
    	return pathGenerator(country);
    })
    .on("mouseover", function(country){
        	this.style.opacity = 0.7
        	svg.select("#CountryName").text(country.properties.name);

        })
    .on("mouseout", function(country){
        	this.style.opacity = 1;
    	})
    .style("fill", function(d) {
    	//CHANGE use data from contraData
    	//something like
    	//return color (pairRateWithId[d.id]);
    	//https://suffenus.wordpress.com/2014/01/07/making-interactive-maps-with-d3-for-total-beginners/
    	return "light grey";
    })
    ;

})


</script>
</body>
</html>